<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="测试开发工程师">
<meta property="og:type" content="website">
<meta property="og:title" content="测试开发技术分享">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="测试开发技术分享">
<meta property="og:description" content="测试开发工程师">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="测试开发技术分享">
<meta name="twitter:description" content="测试开发工程师">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/">





  <title>测试开发技术分享</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">测试开发技术分享</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">走在春风里，满天的繁星追赶着我。</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/01/pytestint/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="iread9527">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="测试开发技术分享">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/01/pytestint/" itemprop="url">pytestint</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-01T22:50:54+08:00">
                2019-08-01
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/接口测试框架/" itemprop="url" rel="index">
                    <span itemprop="name">接口测试框架</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[pytest]</span><br><span class="line">addopts = --strict-markers</span><br><span class="line"></span><br><span class="line">markers =</span><br><span class="line">    p0: <span class="built_in">test</span> <span class="keyword">case</span> tag p0</span><br><span class="line">    p1: <span class="built_in">test</span> <span class="keyword">case</span> tag p1</span><br><span class="line">    global_internal: global</span><br><span class="line">    <span class="built_in">test</span></span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/01/pytest测试框架/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="iread9527">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="测试开发技术分享">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/01/pytest测试框架/" itemprop="url">pytest测试框架</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-01T22:48:31+08:00">
                2019-08-01
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/pytest/" itemprop="url" rel="index">
                    <span itemprop="name">pytest</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="0、-安装"><a href="#0、-安装" class="headerlink" title="0、 安装"></a>0、 安装</h3><h3 id="0-0、-pip-install-U-pytest"><a href="#0-0、-pip-install-U-pytest" class="headerlink" title="0.0、 pip install -U pytest"></a>0.0、 pip install -U pytest</h3><h3 id="0-1、编写pytest测试用例，只需要按照下面的规则："><a href="#0-1、编写pytest测试用例，只需要按照下面的规则：" class="headerlink" title="0.1、编写pytest测试用例，只需要按照下面的规则："></a>0.1、编写pytest测试用例，只需要按照下面的规则：</h3><ul>
<li>测试文件以test_开头（以_test结尾也可以）</li>
<li>测试类以Test开头，并且不能带有 init 方法</li>
<li>测试函数以test_开头</li>
<li>断言使用基本的assert即可</li>
</ul>
<h3 id="1、执行一个文件下的所有测试文件"><a href="#1、执行一个文件下的所有测试文件" class="headerlink" title="1、执行一个文件下的所有测试文件"></a>1、执行一个文件下的所有测试文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pytest testing/</span><br></pre></td></tr></table></figure>

<h3 id="2、给用例打标签并且只执行相应标签的用例"><a href="#2、给用例打标签并且只执行相应标签的用例" class="headerlink" title="2、给用例打标签并且只执行相应标签的用例"></a>2、给用例打标签并且只执行相应标签的用例</h3><h4 id="2-0、在pytest-ini注册标签，strict-markers表示使用没注册标签的用例都会报错，p0为标签，冒号后面是标签的注释，可选"><a href="#2-0、在pytest-ini注册标签，strict-markers表示使用没注册标签的用例都会报错，p0为标签，冒号后面是标签的注释，可选" class="headerlink" title="2.0、在pytest.ini注册标签，strict-markers表示使用没注册标签的用例都会报错，p0为标签，冒号后面是标签的注释，可选"></a>2.0、在pytest.ini注册标签，strict-markers表示使用没注册标签的用例都会报错，p0为标签，冒号后面是标签的注释，可选</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># content of pytest.ini</span></span><br><span class="line">[pytest]</span><br><span class="line">addopts = --strict-markers </span><br><span class="line">markers =</span><br><span class="line">    p0: <span class="built_in">test</span> <span class="keyword">case</span> tag p0</span><br><span class="line">    p1: <span class="built_in">test</span> <span class="keyword">case</span> tag p1</span><br><span class="line">    testid: <span class="built_in">test</span> <span class="keyword">case</span> id</span><br></pre></td></tr></table></figure>

<h4 id="2-1、测试用例"><a href="#2-1、测试用例" class="headerlink" title="2.1、测试用例"></a>2.1、测试用例</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># content of test_mark.py</span></span><br><span class="line">import pytest </span><br><span class="line"></span><br><span class="line">@pytest.mark.p0</span><br><span class="line">@pytest.mark.testid</span><br><span class="line">def test_1():</span><br><span class="line">    assert abs(-1) == 1</span><br><span class="line"></span><br><span class="line">@pytest.mark.p1</span><br><span class="line">def test_2():</span><br><span class="line">    assert abs(-1) == -1</span><br></pre></td></tr></table></figure>

<h4 id="2-2、执行打了特定标签的用例们"><a href="#2-2、执行打了特定标签的用例们" class="headerlink" title="2.2、执行打了特定标签的用例们"></a>2.2、执行打了特定标签的用例们</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pytest -m p0</span><br><span class="line">pytest -m <span class="string">"not p0"</span></span><br><span class="line">pytest -m <span class="string">"p0 or p1"</span></span><br></pre></td></tr></table></figure>

<h3 id="3、pytst的fixture"><a href="#3、pytst的fixture" class="headerlink" title="3、pytst的fixture"></a>3、pytst的fixture</h3><h4 id="3-0、pytest前置和后置用例conftest-py"><a href="#3-0、pytest前置和后置用例conftest-py" class="headerlink" title="3.0、pytest前置和后置用例conftest.py"></a>3.0、pytest前置和后置用例conftest.py</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># content of conftest.py</span></span><br><span class="line">import pytest</span><br><span class="line"></span><br><span class="line"><span class="comment"># scope范围为session,module,class,function,范围前后各执行一次</span></span><br><span class="line">@pytest.fixture(scope=<span class="string">"module"</span>)</span><br><span class="line">def module_fixture():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'module start'</span>)</span><br><span class="line">    yield 1</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'module stop'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@pytest.fixture(scope=<span class="string">"function"</span>)</span><br><span class="line">def function_fixture():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'function start'</span>)</span><br><span class="line">    yield 1</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'function stop'</span>)</span><br></pre></td></tr></table></figure>

<h4 id="3-1、pytest测试用例，可用pytest-s-test-fuction-py查看结果"><a href="#3-1、pytest测试用例，可用pytest-s-test-fuction-py查看结果" class="headerlink" title="3.1、pytest测试用例，可用pytest -s test_fuction.py查看结果"></a>3.1、pytest测试用例，可用<code>pytest -s test_fuction.py</code>查看结果</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># content of test_function.py</span></span><br><span class="line">def test_1(module_fixture, function_fixture):</span><br><span class="line">    assert module_fixture == 1</span><br><span class="line">    assert function_fixture == 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def test_2(module_fixture, function_fixture):</span><br><span class="line">    assert module_fixture == 1</span><br><span class="line">    assert function_fixture == 1</span><br></pre></td></tr></table></figure>

<h4 id="3-2、pytest-fixture具体执行过程"><a href="#3-2、pytest-fixture具体执行过程" class="headerlink" title="3.2、pytest fixture具体执行过程"></a>3.2、pytest fixture具体执行过程</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">1. 先找到所有 test_开头的文件</span><br><span class="line"></span><br><span class="line">2. 在测试脚本文件同一级目录下寻找conftest.py</span><br><span class="line"></span><br><span class="line">3. 按随机顺序执行测试脚本文件中的测试方法</span><br><span class="line"></span><br><span class="line">4. 执行第一个测试方法，发现有一个传入参数 module_fixture，在测试配置文件中寻找名为 module_fixture 的fixture</span><br><span class="line"></span><br><span class="line">5. 执行测试配置文件中的 module_fixture 方法，保存返回值</span><br><span class="line"></span><br><span class="line">6. 把上一步的返回值代入第4步的测试方法传入参数中，执行第一个测试方法</span><br><span class="line"></span><br><span class="line">7. 执行第二个测试方法，发现有一个传入参数 module_fixture ，在测试配置文件中寻找名为 module_fixture 的fixture</span><br><span class="line"></span><br><span class="line">8. 发现这个fixture的范围是module，无需重复执行，使用第5步的返回值继续执行第7步的第二个测试方法</span><br></pre></td></tr></table></figure>

<h3 id="4、pytest-重新执行失败用例"><a href="#4、pytest-重新执行失败用例" class="headerlink" title="4、pytest 重新执行失败用例"></a>4、pytest 重新执行失败用例</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pytest --lf</span><br></pre></td></tr></table></figure>

<h3 id="5、pytest执行打印控制台日志，并设置日志级别"><a href="#5、pytest执行打印控制台日志，并设置日志级别" class="headerlink" title="5、pytest执行打印控制台日志，并设置日志级别"></a>5、pytest执行打印控制台日志，并设置日志级别</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[pytest]</span><br><span class="line">log_cli=<span class="literal">true</span>  </span><br><span class="line">log_level=NOTSET</span><br></pre></td></tr></table></figure>

<h3 id="6、生成测试报告"><a href="#6、生成测试报告" class="headerlink" title="6、生成测试报告"></a>6、生成测试报告</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成xml格式测试报告</span></span><br><span class="line">pytest testing/ --junit-xml=report.xml</span><br><span class="line"><span class="comment"># 插件pytest-html生成测试报告并保留网页格式</span></span><br><span class="line">pytest testing/ --html=report.html --self-contained-html</span><br></pre></td></tr></table></figure>

<h3 id="7、Console参数介绍"><a href="#7、Console参数介绍" class="headerlink" title="7、Console参数介绍"></a>7、Console参数介绍</h3><ul>
<li>-v 用于显示每个测试函数的执行结果</li>
<li>-q 只显示整体测试结果</li>
<li>-s 用于显示测试函数中print()函数输出</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/31/run-tests/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="iread9527">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="测试开发技术分享">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/31/run-tests/" itemprop="url">run_tests</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-31T21:56:07+08:00">
                2019-07-31
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/接口测试框架/" itemprop="url" rel="index">
                    <span itemprop="name">接口测试框架</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="interface-run-tests-py"><a href="#interface-run-tests-py" class="headerlink" title="interface/run_tests.py"></a>interface/run_tests.py</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">import time</span><br><span class="line">import os</span><br><span class="line">import smtplib</span><br><span class="line">from email.mime.text import MIMEText</span><br><span class="line">from email.mime.multipart import MIMEMultipart</span><br><span class="line">from email.header import Header</span><br><span class="line">from email.utils import parseaddr, formataddr</span><br><span class="line">from os.path import abspath</span><br><span class="line">from os.path import dirname</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def _format_addr(s):</span><br><span class="line">    <span class="comment"># 格式化地址</span></span><br><span class="line">    name, address = parseaddr(s)</span><br><span class="line">    <span class="built_in">return</span> formataddr((Header(name, <span class="string">"utf-8"</span>).encode(), address))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def send_email(file_path):</span><br><span class="line">    mail_host = <span class="string">"smtp.163.com"</span></span><br><span class="line">    sender = <span class="string">'18717303689@163.com'</span></span><br><span class="line">    password = <span class="string">"yw455625806a"</span></span><br><span class="line">    receivers = [<span class="string">'2652929865@qq.com'</span>, <span class="string">'18717303689@163.com'</span>]</span><br><span class="line">    file_name = file_path.split(<span class="string">'/'</span>)[-1]</span><br><span class="line">    <span class="built_in">print</span>(file_name)</span><br><span class="line">    with open(file_path, <span class="string">'rb'</span>) as f:</span><br><span class="line">        mail_body = f.read()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 创建一个带附件的实例</span></span><br><span class="line">    message = MIMEMultipart()</span><br><span class="line">    message[<span class="string">'From'</span>] = _format_addr(<span class="string">'emai发送者&lt;&#123;&#125;&gt;'</span>.format(sender))</span><br><span class="line">    <span class="keyword">for</span> receiver <span class="keyword">in</span> receivers:</span><br><span class="line">        message[<span class="string">'To'</span>] = _format_addr(<span class="string">'emai接收者&lt;&#123;&#125;&gt;,'</span>.format(receiver))</span><br><span class="line">    subject = <span class="string">'接口测试测试报告'</span></span><br><span class="line">    message[<span class="string">'Subject'</span>] = Header(subject, <span class="string">'utf-8'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 邮件正文内容</span></span><br><span class="line">    content = MIMEText(<span class="string">'测试报告已发送，请查收，详情见附件。'</span>, <span class="string">'plain'</span>, <span class="string">'utf-8'</span>)</span><br><span class="line">    message.attach(content)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 构造附件</span></span><br><span class="line">    att1 = MIMEText(mail_body, <span class="string">'base64'</span>, <span class="string">'utf-8'</span>)</span><br><span class="line">    att1[<span class="string">"Content-Type"</span>] = <span class="string">'application/octet-stream'</span></span><br><span class="line">    <span class="comment"># 写什么名字，邮件中显示什么名字</span></span><br><span class="line">    att1[<span class="string">"Content-Disposition"</span>] = <span class="string">'attachment; filename=&#123;&#125;'</span>.format(file_name)</span><br><span class="line">    message.attach(att1)</span><br><span class="line"></span><br><span class="line">    try:</span><br><span class="line">        server = smtplib.SMTP(mail_host)</span><br><span class="line">        server.login(sender, password)</span><br><span class="line">        server.sendmail(sender, receivers, message.as_string())</span><br><span class="line">        server.quit()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"邮件发送成功"</span>)</span><br><span class="line">    except smtplib.SMTPException as e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Error: 无法发送邮件"</span>, e)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    now = time.strftime(<span class="string">"%Y-%m-%d_%H:%M:%S"</span>)</span><br><span class="line">    root_file_path = dirname(abspath(__file__))</span><br><span class="line">    report_file_path = root_file_path + <span class="string">'/report/'</span> + now + <span class="string">'_result.html'</span></span><br><span class="line">    test_case_file_path = root_file_path + <span class="string">'/testcases/'</span></span><br><span class="line">    pytest_file_path = root_file_path + <span class="string">'/venv/bin/pytest'</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">command</span> = pytest_file_path + <span class="string">' -q '</span> + test_case_file_path + \</span><br><span class="line">        <span class="string">' --html='</span> + report_file_path + <span class="string">' --self-contained-html'</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'pytest command line: '</span> + <span class="built_in">command</span>)</span><br><span class="line">    os.system(<span class="built_in">command</span>)</span><br><span class="line">    send_email(report_file_path)</span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/31/readme/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="iread9527">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="测试开发技术分享">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/31/readme/" itemprop="url">readme</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-31T21:55:19+08:00">
                2019-07-31
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/接口测试框架/" itemprop="url" rel="index">
                    <span itemprop="name">接口测试框架</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="测试报告：pytest-html"><a href="#测试报告：pytest-html" class="headerlink" title="测试报告：pytest-html"></a>测试报告：pytest-html</h3><h3 id="测试执行器：pytest"><a href="#测试执行器：pytest" class="headerlink" title="测试执行器：pytest"></a>测试执行器：pytest</h3><h3 id="测试驱动库：requests"><a href="#测试驱动库：requests" class="headerlink" title="测试驱动库：requests"></a>测试驱动库：requests</h3><h3 id="测试数据管理：接口数据放在urls目录下的枚举类，测试接口所需数据直接写在用例里面"><a href="#测试数据管理：接口数据放在urls目录下的枚举类，测试接口所需数据直接写在用例里面" class="headerlink" title="测试数据管理：接口数据放在urls目录下的枚举类，测试接口所需数据直接写在用例里面"></a>测试数据管理：接口数据放在urls目录下的枚举类，测试接口所需数据直接写在用例里面</h3><h3 id="代码风格：使用autopep8格式化代码"><a href="#代码风格：使用autopep8格式化代码" class="headerlink" title="代码风格：使用autopep8格式化代码"></a>代码风格：使用autopep8格式化代码</h3><h4 id="1-common模块："><a href="#1-common模块：" class="headerlink" title="1 common模块："></a>1 common模块：</h4><h5 id="1-1-DataProcess-body体中随便命名的加时间戳，响应结果的异常场景处理"><a href="#1-1-DataProcess-body体中随便命名的加时间戳，响应结果的异常场景处理" class="headerlink" title="1.1 DataProcess: body体中随便命名的加时间戳，响应结果的异常场景处理"></a>1.1 DataProcess: body体中随便命名的加时间戳，响应结果的异常场景处理</h5><h5 id="1-2-my-logger-打印日志，可以根据日志大小和时间来切割日志"><a href="#1-2-my-logger-打印日志，可以根据日志大小和时间来切割日志" class="headerlink" title="1.2 my_logger:打印日志，可以根据日志大小和时间来切割日志"></a>1.2 my_logger:打印日志，可以根据日志大小和时间来切割日志</h5><h5 id="1-3-RestClient：通用http请求基础类，把各种http请求还有常用的日志打印封装起来"><a href="#1-3-RestClient：通用http请求基础类，把各种http请求还有常用的日志打印封装起来" class="headerlink" title="1.3 RestClient：通用http请求基础类，把各种http请求还有常用的日志打印封装起来"></a>1.3 RestClient：通用http请求基础类，把各种http请求还有常用的日志打印封装起来</h5><h4 id="2-module模块："><a href="#2-module模块：" class="headerlink" title="2 module模块："></a>2 module模块：</h4><h5 id="2-1-业务层接口的封装，主要的功能是对响应结果的解析取得相应的字段"><a href="#2-1-业务层接口的封装，主要的功能是对响应结果的解析取得相应的字段" class="headerlink" title="2.1 业务层接口的封装，主要的功能是对响应结果的解析取得相应的字段"></a>2.1 业务层接口的封装，主要的功能是对响应结果的解析取得相应的字段</h5><h5 id="2-2-业务层接口封装类原则：每个应该有唯一的id-文件名类名方法名-编写人，创建时间，修改时间-进一步考虑"><a href="#2-2-业务层接口封装类原则：每个应该有唯一的id-文件名类名方法名-编写人，创建时间，修改时间-进一步考虑" class="headerlink" title="2.2 业务层接口封装类原则：每个应该有唯一的id(文件名类名方法名),编写人，创建时间，修改时间(进一步考虑)"></a>2.2 业务层接口封装类原则：每个应该有唯一的id(文件名类名方法名),编写人，创建时间，修改时间(进一步考虑)</h5><h4 id="3-testcases：测试用例"><a href="#3-testcases：测试用例" class="headerlink" title="3 testcases：测试用例"></a>3 testcases：测试用例</h4><h6 id="3-1-最多需要输入四个参数：url-headers-params-data或者json"><a href="#3-1-最多需要输入四个参数：url-headers-params-data或者json" class="headerlink" title="3.1 最多需要输入四个参数：url,headers,params,data或者json"></a>3.1 最多需要输入四个参数：url,headers,params,data或者json</h6><h5 id="3-2-测试用例："><a href="#3-2-测试用例：" class="headerlink" title="3.2 测试用例："></a>3.2 测试用例：</h5><h6 id="3-2-1-每个测试用例都需要分级别并且打标签；-3-2-2-测试用例结果应该校验；"><a href="#3-2-1-每个测试用例都需要分级别并且打标签；-3-2-2-测试用例结果应该校验；" class="headerlink" title="3.2.1 每个测试用例都需要分级别并且打标签；###### 3.2.2 测试用例结果应该校验；"></a>3.2.1 每个测试用例都需要分级别并且打标签；###### 3.2.2 测试用例结果应该校验；</h6><h6 id="3-2-3-需要支持并发执行；-未完成"><a href="#3-2-3-需要支持并发执行；-未完成" class="headerlink" title="3.2.3 需要支持并发执行；(未完成)"></a>3.2.3 需要支持并发执行；(未完成)</h6><h6 id="3-2-4-用例之间的依赖关系"><a href="#3-2-4-用例之间的依赖关系" class="headerlink" title="3.2.4 用例之间的依赖关系;"></a>3.2.4 用例之间的依赖关系;</h6><h6 id="3-2-5-应该有前置用例"><a href="#3-2-5-应该有前置用例" class="headerlink" title="3.2.5 应该有前置用例"></a>3.2.5 应该有前置用例</h6><h4 id="4-run-tests："><a href="#4-run-tests：" class="headerlink" title="4 run_tests："></a>4 run_tests：</h4><h5 id="4-1-支持生成定制的测试报告和发送邮件-用例数，测试报告正确的错误的汇总的，用例id出错在哪-具体错误的日志，总的执行时间"><a href="#4-1-支持生成定制的测试报告和发送邮件-用例数，测试报告正确的错误的汇总的，用例id出错在哪-具体错误的日志，总的执行时间" class="headerlink" title="4.1 支持生成定制的测试报告和发送邮件(用例数，测试报告正确的错误的汇总的，用例id出错在哪,具体错误的日志，总的执行时间)"></a>4.1 支持生成定制的测试报告和发送邮件(用例数，测试报告正确的错误的汇总的，用例id出错在哪,具体错误的日志，总的执行时间)</h5><h5 id="4-2-jekins配置定时任务"><a href="#4-2-jekins配置定时任务" class="headerlink" title="4.2 jekins配置定时任务"></a>4.2 jekins配置定时任务</h5><h5 id="4-3-执行结果有总时间限制（15分钟内完成）"><a href="#4-3-执行结果有总时间限制（15分钟内完成）" class="headerlink" title="4.3 执行结果有总时间限制（15分钟内完成）"></a>4.3 执行结果有总时间限制（15分钟内完成）</h5><h4 id="5-用例自身解耦（删除资源，name唯一），用例和用例之间解耦（并发），用例和环境还有人员解耦"><a href="#5-用例自身解耦（删除资源，name唯一），用例和用例之间解耦（并发），用例和环境还有人员解耦" class="headerlink" title="5 用例自身解耦（删除资源，name唯一），用例和用例之间解耦（并发），用例和环境还有人员解耦"></a>5 用例自身解耦（删除资源，name唯一），用例和用例之间解耦（并发），用例和环境还有人员解耦</h4>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/31/urls/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="iread9527">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="测试开发技术分享">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/31/urls/" itemprop="url">urls</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-31T21:50:16+08:00">
                2019-07-31
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/接口测试框架/" itemprop="url" rel="index">
                    <span itemprop="name">接口测试框架</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="urls-ManagerURL-py"><a href="#urls-ManagerURL-py" class="headerlink" title="urls/ManagerURL.py"></a>urls/ManagerURL.py</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*-coding:utf-8-*-</span></span><br><span class="line">from enum import Enum, unique</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@unique</span><br><span class="line">class ManagerURL(Enum):</span><br><span class="line">    <span class="string">""</span><span class="string">"Manager服务接口"</span><span class="string">""</span></span><br><span class="line">    add_event = <span class="string">'/add_event'</span></span><br><span class="line">    get_event_list = <span class="string">'/get_event_list'</span></span><br></pre></td></tr></table></figure>

<h3 id="urls-RootURL-py"><a href="#urls-RootURL-py" class="headerlink" title="urls/RootURL.py"></a>urls/RootURL.py</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">from enum import Enum, unique</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@unique</span><br><span class="line">class RootURL(Enum):</span><br><span class="line">    beta_global = <span class="string">'http://127.0.0.1:8000/api'</span></span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/31/conftest/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="iread9527">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="测试开发技术分享">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/31/conftest/" itemprop="url">conftest</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-31T21:48:48+08:00">
                2019-07-31
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/接口测试框架/" itemprop="url" rel="index">
                    <span itemprop="name">接口测试框架</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="testcases-conftest-py"><a href="#testcases-conftest-py" class="headerlink" title="testcases/conftest.py"></a>testcases/conftest.py</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import pytest</span><br><span class="line">from urls.root_url import RootURL</span><br><span class="line">from common.DataProcess import DataProcess</span><br><span class="line">from module.iammanager.ManagerDomain import ManagerDomain</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@pytest.fixture(scope=<span class="string">'module'</span>)</span><br><span class="line">def manager_domain():</span><br><span class="line">    domain = ManagerDomain()</span><br><span class="line">    <span class="built_in">return</span> domain</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@pytest.fixture(scope=<span class="string">'module'</span>)</span><br><span class="line">def data_helper():</span><br><span class="line">    data_process = DataProcess()</span><br><span class="line">    <span class="built_in">return</span> data_process</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@pytest.fixture(scope=<span class="string">'module'</span>)</span><br><span class="line">def root_url():</span><br><span class="line">    <span class="built_in">return</span> RootURL.beta_global.value</span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/31/test-add-event/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="iread9527">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="测试开发技术分享">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/31/test-add-event/" itemprop="url">test_add_event</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-31T21:47:03+08:00">
                2019-07-31
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/接口测试框架/" itemprop="url" rel="index">
                    <span itemprop="name">接口测试框架</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="testcases-ManagerDomain-test-add-event-py"><a href="#testcases-ManagerDomain-test-add-event-py" class="headerlink" title="testcases/ManagerDomain/test_add_event.py"></a>testcases/ManagerDomain/test_add_event.py</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">import pytest</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@pytest.mark.p0</span><br><span class="line">@pytest.mark.global_internal</span><br><span class="line">def test_add_del_update_get_event(root_url, manager_domain, data_helper):</span><br><span class="line">    <span class="string">""</span><span class="string">"发布会增删改查组合接口"</span><span class="string">""</span></span><br><span class="line"></span><br><span class="line">    name = add_event(root_url, data_helper, manager_domain)</span><br><span class="line"></span><br><span class="line">    get_event(root_url, name, manager_domain)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def add_event(root_url, data_helper, manager_domain):</span><br><span class="line">    <span class="string">""</span><span class="string">"添加发布会用例"</span><span class="string">""</span></span><br><span class="line">    headers = &#123;<span class="string">'Authorization'</span>: <span class="string">'Basic YWRtaW46YWRtaW4xMjM0NTY='</span>&#125;</span><br><span class="line"></span><br><span class="line">    time_now = data_helper.time_stamp()</span><br><span class="line">    name = data_helper.param_time_stamp(<span class="string">'发布会'</span>)</span><br><span class="line">    body = &#123;<span class="string">'eid'</span>: time_now, <span class="string">'name'</span>: name, <span class="string">'limit'</span>: 2000,</span><br><span class="line">            <span class="string">'address'</span>: <span class="string">"深圳宝体"</span>, <span class="string">'start_time'</span>: <span class="string">'2017-05-10 12:00:00'</span>&#125;</span><br><span class="line"></span><br><span class="line">    result = manager_domain.add_event(</span><br><span class="line">        root_url=root_url, headers=headers, body=body)</span><br><span class="line"></span><br><span class="line">    assert result[<span class="string">'status'</span>] == 200</span><br><span class="line">    assert result[<span class="string">'message'</span>] == <span class="string">'add event success'</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">return</span> name</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_event(root_url, name, manager_domain):</span><br><span class="line">    <span class="string">""</span><span class="string">"获取发布会列表用例"</span><span class="string">""</span></span><br><span class="line">    headers = &#123;<span class="string">'Authorization'</span>: <span class="string">'Basic YWRtaW46YWRtaW4xMjM0NTY='</span>&#125;</span><br><span class="line">    params = &#123;<span class="string">'name'</span>: name&#125;</span><br><span class="line"></span><br><span class="line">    result = manager_domain.get_event_list(</span><br><span class="line">        root_url=root_url, headers=headers, params=params)</span><br><span class="line"></span><br><span class="line">    assert result[<span class="string">'status'</span>] == 200</span><br><span class="line">    assert result[<span class="string">'message'</span>] == <span class="string">'success'</span></span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/31/ManagerDomain/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="iread9527">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="测试开发技术分享">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/31/ManagerDomain/" itemprop="url">ManagerDomain</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-31T21:43:45+08:00">
                2019-07-31
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/接口测试框架/" itemprop="url" rel="index">
                    <span itemprop="name">接口测试框架</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>module/iammanager/ManagerDomain.py</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">import pytest</span><br><span class="line">from urls.root_url import RootURL</span><br><span class="line">from urls.ManagerURL import ManagerURL</span><br><span class="line">from common.RestClient import RestClient</span><br><span class="line">from common.DataProcess import DataProcess</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class ManagerDomain(RestClient):</span><br><span class="line">    <span class="string">""</span><span class="string">"接口调用的封装，主要专注处理返回结果的字段处理"</span><span class="string">""</span></span><br><span class="line"></span><br><span class="line">    def add_event(self, root_url, headers, body):</span><br><span class="line">        <span class="string">""</span><span class="string">"</span></span><br><span class="line"><span class="string">           添加发布会 POST /add_event</span></span><br><span class="line"><span class="string">           接口文档地址</span></span><br><span class="line"><span class="string">        "</span><span class="string">""</span></span><br><span class="line">        log_description = <span class="string">'module-iammanager-ManagerDomain-add_event '</span></span><br><span class="line">        url = root_url + ManagerURL.add_event.value</span><br><span class="line"></span><br><span class="line">        result = self.request(method=<span class="string">'post'</span>, url=url, headers=headers,</span><br><span class="line">                              data=body, log_description=log_description)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> result[<span class="string">'status'</span>] == 200:</span><br><span class="line">            result[<span class="string">'result_message'</span>] = result[<span class="string">'message'</span>]</span><br><span class="line">        self.logger.info(log_description + <span class="string">'result: &#123;&#125;'</span>.format(result))</span><br><span class="line"></span><br><span class="line">        <span class="built_in">return</span> result</span><br><span class="line"></span><br><span class="line">    def get_event_list(self, root_url, headers, params):</span><br><span class="line">        <span class="string">""</span><span class="string">"</span></span><br><span class="line"><span class="string">           添加发布会 GET /get_event_list&#123;?eid,name&#125;</span></span><br><span class="line"><span class="string">           接口文档地址</span></span><br><span class="line"><span class="string">        "</span><span class="string">""</span></span><br><span class="line">        log_description = <span class="string">'module-iammanager-ManagerDomain-get_event_list '</span></span><br><span class="line">        url = root_url + ManagerURL.get_event_list.value</span><br><span class="line"></span><br><span class="line">        result = self.request(method=<span class="string">'get'</span>, url=url, headers=headers,</span><br><span class="line">                              params=params, log_description=log_description)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> result[<span class="string">'status'</span>] == 200:</span><br><span class="line">            result[<span class="string">'event_name'</span>] = result[<span class="string">'data'</span>][0][<span class="string">'name'</span>]</span><br><span class="line">        self.logger.info(log_description + <span class="string">'result: &#123;&#125;'</span>.format(result))</span><br><span class="line"></span><br><span class="line">        <span class="built_in">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="built_in">test</span> = ManagerDomain()</span><br><span class="line">    root_url = RootURL.beta_global.value</span><br><span class="line">    headers = &#123;<span class="string">'Authorization'</span>: <span class="string">'Basic YWRtaW46YWRtaW4xMjM0NTY='</span>&#125;</span><br><span class="line">    name = &#123;<span class="string">'name'</span>: <span class="string">'红米Pro发布会'</span>&#125;</span><br><span class="line">    result = test.get_event_list(root_url=root_url, headers=headers, params=name)</span><br><span class="line">    assert result[<span class="string">'status'</span>], 200</span><br><span class="line">    assert result[<span class="string">'message'</span>], <span class="string">'success'</span></span><br><span class="line"></span><br><span class="line">    headers = &#123;<span class="string">'Authorization'</span>: <span class="string">'Basic YWRtaW46YWRtaW4xMjM0NTY='</span>&#125;</span><br><span class="line"></span><br><span class="line">    data_helper = DataProcess()</span><br><span class="line">    time_now = data_helper.time_stamp()</span><br><span class="line">    name = data_helper.param_time_stamp(<span class="string">'发布会'</span>)</span><br><span class="line">    body = &#123;<span class="string">'eid'</span>: time_now, <span class="string">'name'</span>: name, <span class="string">'limit'</span>: 2000,</span><br><span class="line">            <span class="string">'address'</span>: <span class="string">"深圳宝体"</span>, <span class="string">'start_time'</span>: <span class="string">'2017-05-10 12:00:00'</span>&#125;</span><br><span class="line"></span><br><span class="line">    result = test.add_event(</span><br><span class="line">        root_url=root_url, headers=headers, body=body)</span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/29/dataprocess/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="iread9527">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="测试开发技术分享">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/29/dataprocess/" itemprop="url">dataprocess</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-29T23:15:42+08:00">
                2019-07-29
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/接口测试框架/" itemprop="url" rel="index">
                    <span itemprop="name">接口测试框架</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="dataprocess"><a href="#dataprocess" class="headerlink" title="dataprocess"></a>dataprocess</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">import time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class DataProcess(object):</span><br><span class="line">    <span class="string">""</span><span class="string">"处理自动化输入字符串唯一和结果处理的辅助类"</span><span class="string">""</span></span><br><span class="line"></span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.time_now = int(time.time())</span><br><span class="line">        self.time_now_str = str(self.time_now)</span><br><span class="line"></span><br><span class="line">    def time_stamp(self):</span><br><span class="line">        <span class="built_in">return</span> self.time_now</span><br><span class="line"></span><br><span class="line">    def param_time_stamp(self, input_param):</span><br><span class="line">        <span class="string">""</span><span class="string">"</span></span><br><span class="line"><span class="string">        情况一：如果input_param包含iam_，input_param不做处理</span></span><br><span class="line"><span class="string">        情况二：如果input_param包含none，input_param返回空字符串</span></span><br><span class="line"><span class="string">        情况三：除前面两种情况，input_param加时间戳</span></span><br><span class="line"><span class="string">        :param input_param: str</span></span><br><span class="line"><span class="string">        :return: str</span></span><br><span class="line"><span class="string">        "</span><span class="string">""</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">'iam_'</span> <span class="keyword">in</span> input_param:</span><br><span class="line">            <span class="built_in">return</span> input_param</span><br><span class="line">        <span class="keyword">elif</span> <span class="string">'none'</span> <span class="keyword">in</span> input_param:</span><br><span class="line">            <span class="built_in">return</span> <span class="string">''</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">return</span> input_param + self.time_now_str</span><br><span class="line"></span><br><span class="line">    def content_handler(self, response):</span><br><span class="line">        <span class="string">""</span><span class="string">"</span></span><br><span class="line"><span class="string">        响应结果为空，返回no_content,响应结果包含&#123;，直接反馈结果，否则响应结果解析成json,然后返回</span></span><br><span class="line"><span class="string">        "</span><span class="string">""</span></span><br><span class="line">        content = response.text</span><br><span class="line">        <span class="keyword">if</span> content == <span class="string">''</span>:</span><br><span class="line">            <span class="built_in">return</span> <span class="string">'no content'</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="string">'&#123;'</span> not <span class="keyword">in</span> content:</span><br><span class="line">            <span class="built_in">return</span> content</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result = response.json()</span><br><span class="line">            result[<span class="string">'status_code'</span>] = response.status_code</span><br><span class="line">            result[<span class="string">'cost_time'</span>] = response.elapsed.microseconds</span><br><span class="line">            <span class="built_in">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    data_helper = DataProcess()</span><br><span class="line">    <span class="built_in">print</span>(data_helper.time_stamp())</span><br><span class="line">    <span class="built_in">print</span>(data_helper.param_time_stamp(<span class="string">'iam_jfwf'</span>))</span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/29/RestClient/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="iread9527">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="测试开发技术分享">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/29/RestClient/" itemprop="url">RestClient</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-29T23:08:40+08:00">
                2019-07-29
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/接口测试框架/" itemprop="url" rel="index">
                    <span itemprop="name">接口测试框架</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="封装request方法"><a href="#封装request方法" class="headerlink" title="封装request方法"></a>封装request方法</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">from common.my_logger import my_logger</span><br><span class="line">from common.DataProcess import DataProcess</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class RestClient(object):</span><br><span class="line">    <span class="string">""</span><span class="string">"通用request请求封装类"</span><span class="string">""</span></span><br><span class="line"></span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.logger = my_logger()</span><br><span class="line">        self.response_helper = DataProcess()</span><br><span class="line"></span><br><span class="line">    def request(self, method, url, headers,  params=None, json=None, data=None, log_description=None):</span><br><span class="line">        <span class="string">""</span><span class="string">"</span></span><br><span class="line"><span class="string">        http方法的封装</span></span><br><span class="line"><span class="string">        :param method:http请求的方法，str</span></span><br><span class="line"><span class="string">        :param url:http请求的url,str</span></span><br><span class="line"><span class="string">        :param headers:http请求的header，dict</span></span><br><span class="line"><span class="string">        :param params:http请求的查询参数，dict</span></span><br><span class="line"><span class="string">        :param json:http请求的body体，json</span></span><br><span class="line"><span class="string">        :param data:http请求的body体，dict</span></span><br><span class="line"><span class="string">        :param log_description:每个测试类通用的日志打印格式，str</span></span><br><span class="line"><span class="string">        :return:http响应的处理结果，json</span></span><br><span class="line"><span class="string">        "</span><span class="string">""</span></span><br><span class="line"></span><br><span class="line">        result = &#123;&#125;</span><br><span class="line"></span><br><span class="line">        try:</span><br><span class="line">            <span class="keyword">if</span> method == <span class="string">'post'</span>:</span><br><span class="line">                response = requests.post(</span><br><span class="line">                    url, headers=headers, params=params, json=json, data=data)</span><br><span class="line">            <span class="keyword">elif</span> method == <span class="string">'get'</span>:</span><br><span class="line">                response = requests.get(</span><br><span class="line">                    url, headers=headers, params=params, json=json, data=data)</span><br><span class="line">            <span class="keyword">elif</span> method == <span class="string">'put'</span>:</span><br><span class="line">                response = requests.put(</span><br><span class="line">                    url, headers=headers, params=params, json=json, data=data)</span><br><span class="line">            <span class="keyword">elif</span> method == <span class="string">'delete'</span>:</span><br><span class="line">                response = requests.delete(</span><br><span class="line">                    url, headers=headers, params=params, json=json, data=data)</span><br><span class="line">            <span class="keyword">elif</span> method == <span class="string">'patch'</span>:</span><br><span class="line">                response = requests.patch(</span><br><span class="line">                    url, headers=headers, params=params, json=json, data=data)</span><br><span class="line">            <span class="keyword">elif</span> method == <span class="string">'head'</span>:</span><br><span class="line">                response = requests.head(</span><br><span class="line">                    url, headers=headers, params=params, json=json, data=data)</span><br><span class="line">            <span class="keyword">elif</span> method == <span class="string">'options'</span>:</span><br><span class="line">                response = requests.options(</span><br><span class="line">                    url, headers=headers, params=params, json=json, data=data)</span><br><span class="line"></span><br><span class="line">        except Exception as e:</span><br><span class="line">            result[<span class="string">'error_description'</span>] = e</span><br><span class="line">            self.logger.error(log_description + <span class="string">'error: &#123;&#125;'</span>.format(e))</span><br><span class="line">            <span class="built_in">return</span> result</span><br><span class="line"></span><br><span class="line">        self.logger.info(log_description + <span class="string">'url: &#123;&#125;'</span>.format(response.url))</span><br><span class="line">        self.logger.info(log_description + <span class="string">'params: &#123;&#125;'</span>.format(params))</span><br><span class="line">        self.logger.info(log_description + <span class="string">'headers: &#123;&#125;'</span>.format(headers))</span><br><span class="line">        self.logger.info(log_description + <span class="string">'body: &#123;&#125;'</span>.format(json))</span><br><span class="line">        self.logger.info(log_description + <span class="string">'response status_code: &#123;&#125;, '</span></span><br><span class="line">                                           <span class="string">'content: &#123;&#125;'</span>.format(response.status_code, response.text))</span><br><span class="line"></span><br><span class="line">        result = self.response_helper.content_handler(response)</span><br><span class="line"></span><br><span class="line">        <span class="built_in">return</span> result</span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">iread9527</p>
              <p class="site-description motion-element" itemprop="description">测试开发工程师</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">12</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">iread9527</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
